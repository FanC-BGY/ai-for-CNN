定位系统定义

定位理论有两种：地图的定位方法以及基于未知地图的定位方法。

基于已知地图定位方法：顾名思义，就是事先获取机器人的工作环境地图（高精度地图），然后根据高精度地图结合激光雷达及其它传感器通过定位算法获得准确的位置估计。室外无人驾驶技术普遍采用的是基于已知地图的定位方法。

基于位置地图的定位方法：指在地图和机器人的位置都事先未知的情况下，要求机器人在一个完全未知的环境中从一个未知的位置出发，在递增地建立环境的导航地图，同时利用已建立的地图来同步刷新自身的位置。该问题被称作同步定位和构图，简称 SLAM。


## 定位系统分类

- 室外定位技术

  ![](.\img\GNSS.jpg)

  - 卫星定位技术(GNSS-)Global Navigation Satellite System

    - GPS

      - 参考资料
        - [卫星定位系统简介--八杰科技](https://wenku.baidu.com/view/b1e2691376232f60ddccda38376baf1ffc4fe39f.html)
        - [GPS发展过程及GPS现代化](https://wenku.baidu.com/view/e099c777ec630b1c59eef8c75fbfc77da269979c.html?from=search)
      - roadmap
        - 1958年美国海军武器实验室
        - 1964年子午卫星系统（军用）
        - 1973年NAVSTAR GPS投入使用
        - 1994年全面建成第一代
      - 参数
        - 民用精度10m，军用1m
        - 卫星高度20200千米，运行周期11小时58分
        - 单向测距被动式接收导航电文，北斗是双向型主动询问定位。用户设备上装发射机
        - 24颗卫星（3颗备用），6个轨道面（每个轨道面4颗卫星），轨道[倾角](https://zhidao.baidu.com/question/1241940924262103699.html)55度，还有4 颗有源备份卫星在轨运行，并能保持良好定位解算精度的几何图象。这就提供了在时间上连续的全球导航能力
        - 确保全球任何地点、任何时间能同时观测到6-9颗卫星（实际上最多能观测到11颗）
        - GPS 卫星产生两组电码，一组称为C/ A 码（Coarse/ Acquisition Code1.023MHz)；一组称P码（Procise Code 10.23MHz),P 码因频率较高，不易受干扰，定位精度高，因此受美国军方管制，并设有密码，一般民间无法解读，主要为美国军方服务。C/ A 码人为采取措施而刻意降低精度后，主要开放给民间使用。
          - C/A码
            - 军用
            - 1.023MHz
            - 重复周期一毫秒
            - 码间距1微秒（300m）
          - P码
            - 民用
            - 10.23MHz
            - 重复周期266.4天
            - 码间距0.1微秒（30m）
        - 导航电文包括卫星星历、工作状况、时钟改正、电离层时延修正、大气折射修正等信息。它是从卫星信号中解调制出来，以50b/s调制在载频上发射的。导航电文每个主帧中包含5个子帧每帧长6s
        - GPS接收机可接收到可用于授时的准确至纳秒级的时间信息；用于预报未来几个月内卫星所处概略位置的预报星历；用于计算定位时所需卫星坐标的广播星历，精度为几米至几十米（各个卫星不同，随时变化）；以及GPS系统信息，如卫星状况等
        - 地面控制部分由一个主控站,5 个全球监测站和3个地面控制站组成

    - GLONASS

      - roadmap

        - 上个世纪80年代开始
        - 2006年 17颗卫星
        - 2011年28颗卫星

      - 参数

        - 精度号称1m

        - 组成部分：卫星、地面测控站和用户设备

        - 21用3备，三个轨道平面，每个轨道平面8颗卫星。轨道高度1万9000公里，周期11小时15分

          ![GLONASS](.\img\GLONASS.jpg)

    - GALILEO

      - roadmap
        - 2002年启动
        - 2005年首颗卫星
      - 参数
        - 精度1m，GPS只能找到街道，GALILEO可以找到车库的门
        - 卫星高度24126公里
        - 30颗卫星，27用3备
        - 3个轨道面，倾角56度

    - BDS

      - roadmap

        - 第一步 少量同步卫星完成实验任务

        - 第二步 2012年 发射10颗卫星覆盖亚太地区

        - 第三步 2020年5颗同步卫星+30颗非同步卫星组网

        - 工程期限1994年-2020年， 工程总投资100亿元

          ![](.\img\beidou_road.jpg)

      - 参数

        - 5+30颗卫星
        - 工作频率：2491.75MHz
        - 水平定位精度100m，设立标校站之后为20m
        - 授时精度20ns-100ns
        - 系统容量：每小时540000户
        - 覆盖范围东经70-140度，北纬5到55度

        ![北斗](.\img\beidou.jpg)

  - 移动通信网定位技术[采用cell-id方式]

    - 基站定位
      - 基站定位利用移动通信网络的基站上接收到的信号来估计移动终端用户的位置
    - 终端定位
      - 终端定位由移动终端通过测量接收到的移动通信网各基站的信号来估计自身的位置

- 室内定位技术

  - 参考资料
- [七大室内定位技术PK](https://blog.csdn.net/ZHANGHUI3239619/article/details/78746942)
  
    - [十一种室内定位传感器方案汇总介绍与对比（机器人、物联网领域）](https://blog.csdn.net/xingdou520/article/details/84104644)
- 各种室内定位技术精度比较
  - ![](.\img\定位精度.png)
  
  ![](.\img\定位精度-表格.jpg)
  
- 超声波的室内定位系统(Active Bat/Cricket)
  
    - 简单的超声波定位系统
    
      ![](.\img\超声波-蝙蝠.jpg)
    
- 原理：
  
  - 技术实现原理：利用测量超声波传输时间来计算其距离。
  
    - 基本原理一：超声波定位技术通过在室内安装多个超声波扬声器，发出能被终端麦克风检测到的超声信号。通过不同声波的到达时间差，推测出终端的位置。由于声波的传送速度远低于电磁波，其系统实现难度非常低，可以非常简单地实现系统的无线同步，然后用超声波发送器发送，接收端采用麦克风接收，自己运算位置即可。
  
    - 基本原理二：将超声波发生器置于被定位的目标上面，向周围按照一定的时间间隔发送超声波脉冲，在周围3个固定位置上分别接收超声波发射装置发出来的脉冲信号，由于超声波在空间传送速度比较慢，所以通过比较三个接收装置收到信号的时间先后，可以反演出超声波发生器的具体位置，也就是被定位目标的位置，当目标移动时候，可以通过不间断测量，描出目标的运动轨迹。

  
    - 三个超声波发射器的摆放位置决定了其本地坐标系，如下图所示（其中黄色圆圈代表发射器）
  
    - ![](.\img\超声波-三个发射器.jpg)
  
      ![](.\img\超声波接收器.jpg)
  
      ![](.\img\超声波发射器.jpg)
  
    - 发射端发射声波信号，并同时通过射频信号通知接收端开始计时，当接收器接收到声波时结束计时，则此发射器和接收器之间的距离为声速*t。依次计算三个发射器和接收器各自的距离
  
    - 设此时接收器坐标为(x,y,z)，且通过结构定义已知三个发射器的坐标以及各自和接收器的距离关系，就可以根据两点间距离公式
  
    ​                         (x-x’)2+(y-y’)2+(z-z’)2=d
  
  - 优缺点
  
      - 优点：声波传播速度满，系统容易时间同步，方向性好，穿透性好，抗干扰强，受环境影响小、技术难度低，成本低
      - 缺点：大量遮挡的地方无法使用
  
      
  
  - 超声波传感器
    - ![](.\img\超声波传感器.jpg)
    - ![](.\img\超声波传感器1.jpg)
  
  
  
  - 红外线室内定位系统
  
    - 参考文档
  
    - 分类：
  
      - 第一种是被定位目标使用红外线IR标识作为移动点，发射调制的红外射线，通过室内安放的多个红外传感器测量信号源的距离或角度，从而计算出对象所在的位置
      
        ![](.\img\红外-标签定位.jpg)
      
      - 第二种是通过多对发射器和接收器织红外线网覆盖待测空间，直接对运动目标进行定位
      
        ![](.\img\红外定位系统-网格.jpg)
      
        ![](.\GPS\img\红外-网格2.jpg)
  
  - **技术实现原理**：主要通过在已知节点处的红外线发射设备发射调制的红外线，然后在待测节点布置好的光学传感器接收这些红外信号，经过对红外信号的处理，计算出距离，从而达到定位效果。
  
    - roadmap
  
    - 参数
  
      - 优点：定位精度较高、技术成熟
  
      - 缺点： 
  
        1）红外线传播距离较短。
  
        2）红外线没有越过障碍物的能力，这就要求定位环境没有障碍物，或说定位只能在可视距条件下传播。当标识放在口袋里或者有墙壁及其他遮挡时就不能正常工作。
  
        3）室外抗光性差，非常容易被荧光灯或者房间内的灯光、阳光干扰导致系统无法工作
        
        4）无论哪种方式，都需要在每个遮挡背后、甚至转角都安装接收端，布局复杂，使得成本提升，而定位效果有限
  
  - 无线电射频识别(Radio Frequency Identification, RFID）
  
    - 参考文档
  
    - 原理：定位系统的基本硬件组成：标签（TAG），锚点/读写器（Anchor、Reader），时间同步器（采用TDOA机制需要的设备）RFID又称射频识别技术，是一种非接触式自动识别技术。RFID标签具有体积小、读写范围广、寿命长、抗干扰能力强等特点，可支持快速读写、移动识别、多目标识别、唯一表示等，和GPS相比更适合室内定位。有源标签相比无源标签有更远的识别距离和更大的存储容量，与互联网、通信技术结合，可实现全球范围内物品的跟踪和信息哦共享，极大的扩展了射频识别技术的应用领域。读卡器通过天线发射一定频率的射频信号，这些电磁波激活标签电路，标签的能量检测电路将一部分射频信号转换成直流信号能量供其工作，标签获得能量被激活后，将自身的序列号等信息调制到射频信号上后通过标签天线发送出去，读写器接收到标签返回的射频信号后，对该信号进行解调和解码；有源标签自身内嵌电池供电，利用自身的射频能量主动发送数据给读写器。
  
      
  
    - 参数
      
      - ![](.\img\RFID 频段.jpg)
      
    - 优缺点
  
      - 优点：RFID标签实现了无接触操作，具有体积小，容量大，应用便利，无机械磨损，寿命长，无需可见光源，穿透性好，可重复使用，抗污染能力和耐久性强等特点。并且，RFID标签可以在恶劣环境下工作，读取距离远，并使用了防碰撞技术，可支持多个目标的快速读写、多目标识别、移动识别、非可视识别、实时定位及长期跟踪管理
  
  - 蓝牙
  
  - 无线局域网(Wireless Local Area Network,WLAN)定位
  
  - ZigBee技术
  
  - 超宽带(Ultra Wideband, UWB)
  
    - 参考文档
  
      - [UWB测距及定位原理](https://wenku.baidu.com/view/34f81dde8ad63186bceb19e8b8f67c1cfad6ee09.html?from=search)
  
    - 原理
  
      - 超宽带技术是一种全新的、与传统通信技术有极大差异的通信新技术。它不需要使用传统通信体制中的载波，而是通过发送和接收具有纳秒或皮秒级的极窄脉冲来传输数据，从而具有GHz量级的带宽。
      - ![](.\img\UWB系统图.jpg)
    - ![](.\img\uwb1维.png)
      - ![](.\img\uwb2维.png)
    - ![](.\img\uwb3维.png)
    
  - 参数
    
    - 系统定位精度高达三维15cm，为目前无线电定位最高精度；
    
    - 标签刷新率从0.002Hz-33Hz可以根据环境自动分配；  
    
      - 标签内置振动传感器、纽扣电池可供1年供电；
    
    - 支持Linux和Windows环境，分布式结构；
  
  
  
  
    - 优缺点
  
      - 优点：具有穿透力强、功耗低、抗多径效果好，安全性高、精度高、对其他设备干扰小、容量高
  
  - 视觉定位系统
  
  - 磁场定位系统：计算机基站+RF 发射机+传感器+控制器
  
  - WSN定位技术：无线传感器网络wireless sensor network
  
  - 激光传感器定位系统



- 参考资料
  - [定位技术分类](https://blog.csdn.net/Ada384984398/article/details/79060987)



## 算法原理

- 系统和算法
  
  - ![](.\img\系统和选用的算法.jpg)
  
- 参考资料
  
  - [无线定位原理：TOA & AOA](https://blog.csdn.net/qq_23947237/article/details/82738191)
  
- 时间到达法（TOA）
  - 原理
    
    - TOA 定位方法，主要是根据测量接收信号在基站和移动台之间的**到达时间**，然后转换为距离，从而进行定位。该方法至少需要三个基站，才能计算目标的位置，其定位示意图如图所示。
    
    - 1、Anchor首先发给Tag一个包，同时记录下Anchor当前的时间信息，记为T1。
    
      2、Tag收到基站的信息，返回一个ACK。
    
      3、 Anchor收到Tag的ACK，记录当前的时间信息，记为T2。
    
      4、Anchor计算时间差Tr = T2 - T1，并且根据此计算出距离。
    
      d = c * Tr / 2 其中c为光速。
  - 图示
    
    - ![](.\img\TOA示意图.jpg)
  
- 时间到达差法（TDOA）

  - 原理

    - 不同于TOA，TDOA（到达时间差）是通过检测信号到达两个基站的时间差，而不是到达的绝对时间来确定移动台的位置，降低了时间同步要求。采用三个不同的基站可以测到两个TDOA，移动站位于两个TDOA决定的双曲线的交点上
    - DOA算法是对TOA算法的改进，他不是直接利用信号到达时间，而是用多个基站接收到信号的时间差来确定移动台位置，与TOA算法相比他不需要加入专门的时间戳，定位精度也有所提高。TDOA值的获取一般有2种形式：
      - 第1种形式是利用移动台到达2个基站的时间TOA，取其差值来获得，这时仍需要基站时间的严格同步，但是当两基站间移动信道传输特性相似时，可减少由多径效应带来的误差，如图3所示。
      - 第2种形式是将一个移动台接收到的信号与另一个移动台接收到的信号进行相关运算，从而得到TDOA的值，这种算法可以在基站和移动台不同步时，估计出TDOA的值，由于实际应用中，往往很难做到基站与移动台的同步，所以利用相关估计得到TDOA值，再进行定位计算能获得较高精度。对于蜂窝网中的移动台定位而言，TDOA更具有实际意义，这种方法对网络的要求相对较低，并且定位精度较高，目前已经成为研究的热点。

    ![](.\img\TDOA示意图.jpg)

    ![](.\img\TDOA双曲线.png)

    - 步骤

      - 1、Tag发出一个广播包。

        2、 两个Anchor接收到同一个包，Anchor1接收到的时间为T1，Anchor2接收到的时间为T1。

        3、计算时间差Td = T2 - T1。

        4、 对于至少四个Anchor，可以得到三组这样的两两之间的信息。

        5、通过数学方法（multi-lateration）可以解算出Tag的空间坐标。

        由此可见，TDOA的优势首先在于一次定位的通信次数显著减少，其次由于是用时间差而非绝对时间进行测距，其精度也比TOA高出一些。但优势总是以一些代价换来的，TDOA系统中各个Anchor的时钟必须严格同步，由于这种定位本质上是依赖于光速的，所以1ns的固有时钟误差便可以造成30cm的固有距离误差，这一点显然是不可接受的。而要打造一个间距比较大的精确同步系统成本又是比较高昂的。

- 信号强度法（RSSI）

  - **无线传输距离计算**

    Pr(dBm) = Pt(dBm) - Ct(dB) + Gt(dB) - FL(dB) + Gr(dB) - Cr(dB) 

    Pr：接受端灵敏度
    Pt: 发送端功率
    Cr: 接收端接头和电缆损耗
    Ct: 发送端接头和电缆损耗
    Gr: 接受端天线增益
    Gt: 发送端天线增益
    FL: 自由空间损耗

    FL(dB)=20 lg R (km) +20 lg f (GHz) + 92.44

    R是两点之间的距离
    f是频率=2.4

- 到达角度差法（AOA）
  - AOA 定位方法，主要是测量信号移动台和基站之间的到达角度，以基站为起点形成的射线必经过移动台，两条射线的交点即为移动台的位置。该方法只需两个基站就可以确定 MS 的估计位置，其定位示意图如图所示。
  - ![](.\img\AOA示意图.jpg)



## 参数对比



## 误差及校准

